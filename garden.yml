kind: Project
name: cache-service
environments:
  - name: local
    providers:
      - name: local-kubernetes
        setupIngressController: false
---
kind: Module
description: cache service server
name: cache-service-server
type: container
dockerfile: ./build/package/Dockerfile
services:
  - name: cache-service-server
    args:
      - cache-service
      - server
    ports:
      - name: grpc
        containerPort: 3000
        servicePort: 3000
    ingresses:
      - port: grpc
    env:
      REDIS_PASSWORD:
        secretRef:
          name: redis-password-secret
          key: redis-password
    dependencies:
      - redis
---
kind: Module
name: redis
description: redis server
type: helm
chart: stable/redis
values:
  existingSecret: redis-password-secret
  usePasswordFile: true
  usePassword: true
---
kind: Module
name: redis-secret
description: redis secret
type: kubernetes
files:
  - ./k8s/redis-secret.yaml
