kind: Project
name: cache-service
environments:
  - name: local
    providers:
      - name: local-kubernetes
        setupIngressController: false
---
kind: Module
description: cache service server
name: cache-service-server
type: container
dockerfile: ./build/package/Dockerfile
services:
  - name: cache-service-server
    args:
      - cache-service
      - server
    ports:
      - name: grpc
        containerPort: 3000
        servicePort: 3000
    ingresses:
      - port: grpc
---
kind: Module
description: Ambassador API Gateway
type: helm
name: ambassador
chart: stable/ambassador
values:
  service:
    annotations:
      getambassador.io/config: |
        ---
        apiVersion: ambassador/v1
        kind: Module
        name: ambassador
        config:
          service_port: 8080 # Set port since the default ingress already occupies the default port
    http:
      port: 8080 # Set port since the default ingress already occupies the default port
